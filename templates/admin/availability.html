{% extends 'admin/base.html' %}

{% block title %}Availability{% endblock %}
{% block page_title %}ЁЯУж рд╕рд╛рдорд╛рди рдЙрдкрд▓рдмреНрдзрддрд╛ (Product Availability){% endblock %}

{% block content %}
<!-- Stats -->
<div class="grid grid-cols-2 gap-4 mb-6">
    <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-4 text-white">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-green-100 text-sm">рдЙрдкрд▓рдмреНрдз</p>
                <h3 class="text-3xl font-bold">{{ products|length - unavailable_count }}</h3>
                <p class="text-green-100 text-xs">Available</p>
            </div>
            <div class="text-4xl opacity-80">тЬЕ</div>
        </div>
    </div>
    <div class="bg-gradient-to-br from-red-500 to-red-600 rounded-2xl p-4 text-white">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-red-100 text-sm">рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ</p>
                <h3 class="text-3xl font-bold">{{ unavailable_count }}</h3>
                <p class="text-red-100 text-xs">Unavailable</p>
            </div>
            <div class="text-4xl opacity-80">тЭМ</div>
        </div>
    </div>
</div>

<!-- Products List -->
<div class="bg-white rounded-2xl shadow-sm p-6">
    <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-bold text-gray-800">ЁЯУЛ рд╕рднреА рд╕рд╛рдорд╛рди рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛</h3>
        <p class="text-sm text-gray-500">Click to toggle availability</p>
    </div>
    
    {% if products %}
    <div class="space-y-3">
        {% for product in products %}
        <div class="flex items-center justify-between p-4 {% if product.is_available %}bg-green-50 border border-green-200{% else %}bg-red-50 border border-red-200{% endif %} rounded-xl">
            <div class="flex items-center space-x-4">
                <!-- Product Image -->
                <div class="w-14 h-14 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0">
                    {% if product.image and product.image != 'default.png' %}
                        {% if product.image.startswith('http') %}
                            <img src="{{ product.image }}" 
                                 alt="{{ product.name }}"
                                 class="w-full h-full object-cover">
                        {% else %}
                            <img src="{{ url_for('static', filename='images/uploads/' + product.image) }}" 
                                 alt="{{ product.name }}"
                                 class="w-full h-full object-cover">
                        {% endif %}
                    {% else %}
                        <div class="w-full h-full flex items-center justify-center text-2xl bg-amber-100">ЁЯЫТ</div>
                    {% endif %}
                </div>
                
                <div>
                    <p class="font-semibold text-gray-800">{{ product.name }}</p>
                    <p class="text-sm text-gray-500">тВ╣{{ product.price|int }}</p>
                </div>
            </div>
            
            <div class="flex items-center space-x-3">
                <!-- Status Badge -->
                <span class="px-3 py-1 {% if product.is_available %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %} text-sm font-medium rounded-full">
                    {% if product.is_available %}
                        тЬЕ рдЙрдкрд▓рдмреНрдз
                    {% else %}
                        тЭМ рдирд╣реАрдВ рд╣реИ
                    {% endif %}
                </span>
                
                <!-- Toggle Button -->
                <form action="{{ url_for('admin_toggle_availability', product_id=product.id) }}" method="POST">
                    <button type="submit" 
                            class="px-4 py-2 {% if product.is_available %}bg-red-500 hover:bg-red-600{% else %}bg-green-500 hover:bg-green-600{% endif %} text-white font-medium rounded-xl transition-all text-sm">
                        {% if product.is_available %}
                            тЭМ Mark Unavailable
                        {% else %}
                            тЬЕ Mark Available
                        {% endif %}
                    </button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-12 text-gray-500">
        <div class="text-5xl mb-4">ЁЯУж</div>
        <p>рдХреЛрдИ рд╕рд╛рдорд╛рди рдирд╣реАрдВ рд╣реИ</p>
        <a href="{{ url_for('admin_add_product') }}" class="inline-block mt-4 px-6 py-2 bg-primary text-white rounded-xl">Add Product</a>
    </div>
    {% endif %}
</div>

<!-- Quick Tips -->
<div class="mt-6 bg-amber-50 border border-amber-200 rounded-2xl p-4">
    <h4 class="font-bold text-amber-800 mb-2">ЁЯТб рдЯрд┐рдкреНрд╕</h4>
    <ul class="text-sm text-amber-700 space-y-1">
        <li>тАв <strong>рдЙрдкрд▓рдмреНрдз (Available)</strong> рд╕рд╛рдорд╛рди рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рджрд┐рдЦреЗрдЧрд╛</li>
        <li>тАв <strong>рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ (Unavailable)</strong> рд╕рд╛рдорд╛рди рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдирд╣реАрдВ рджрд┐рдЦреЗрдЧрд╛</li>
        <li>тАв рдЪреИрдЯрдмреЙрдЯ рднреА рд╕рд┐рд░реНрдл рдЙрдкрд▓рдмреНрдз рд╕рд╛рдорд╛рди рдмрддрд╛рдПрдЧрд╛</li>
    </ul>
</div>
{% endblock %}
